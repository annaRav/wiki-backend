quarkus.application.name=axis-notification
quarkus.http.port=8082

# CORS Configuration (for React frontend)
quarkus.http.cors=true
quarkus.http.cors.origins=/.*/
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.exposed-headers=Content-Disposition,Content-Type,Authorization
quarkus.http.cors.access-control-allow-credentials=true
quarkus.http.cors.access-control-max-age=24H

# Virtual threads (Java 21 feature for better blocking I/O handling)
quarkus.virtual-threads.enabled=true
quarkus.virtual-threads.name-prefix=vt-axis-notification-

# Datasource
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=jdbc:postgresql://${DB_HOST:postgres-app}:${DB_PORT:5432}/${DB_NAME:notification}
quarkus.datasource.username=${DB_USERNAME:notification_user}
quarkus.datasource.password=${DB_PASSWORD:axis_password}
quarkus.datasource.jdbc.max-size=10
quarkus.datasource.jdbc.min-size=5

# Hibernate
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.dialect=org.hibernate.dialect.PostgreSQLDialect
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.log.format-sql=true
quarkus.hibernate-orm.jdbc.timezone=UTC

# Liquibase
quarkus.liquibase.migrate-at-start=true
quarkus.liquibase.change-log=db/changelog/db.changelog-master.yaml
quarkus.liquibase.default-schema-name=public

# OIDC / Keycloak - Resource Server mode (validates Bearer tokens)
# Gets JWKS directly from Keycloak inside cluster, ignores issuer mismatch for dev
quarkus.oidc.auth-server-url=http://keycloak:8080/realms/axis
quarkus.oidc.client-id=axis-backend
quarkus.oidc.credentials.secret=${KEYCLOAK_CLIENT_SECRET:secret}
quarkus.oidc.application-type=service
quarkus.oidc.discovery-enabled=true
quarkus.oidc.token.issuer=any

# Security
quarkus.http.auth.permission.public.paths=/q/*
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.options.paths=/api/*
quarkus.http.auth.permission.options.policy=permit
quarkus.http.auth.permission.options.methods=OPTIONS
quarkus.http.auth.permission.authenticated.paths=/api/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# Health probes (match K8s expectations)
quarkus.smallrye-health.root-path=/actuator/health
quarkus.smallrye-health.liveness-path=liveness
quarkus.smallrye-health.readiness-path=readiness

# Metrics
quarkus.micrometer.export.prometheus.enabled=true
quarkus.micrometer.export.prometheus.path=/q/metrics

# OpenAPI
quarkus.smallrye-openapi.path=/api-docs
quarkus.swagger-ui.path=/swagger-ui
quarkus.swagger-ui.always-include=true

# Logging
quarkus.log.level=INFO
quarkus.log.category."com.axis".level=DEBUG
quarkus.log.category."io.quarkus.security".level=DEBUG
quarkus.log.category."org.hibernate.SQL".level=DEBUG
quarkus.log.category."org.hibernate.type.descriptor.sql.BasicBinder".level=TRACE
